# This file is automatically generated by Cookiecutter.

# Define the stages of the pipeline
stages:
  - quality

variables:
  UV_VERSION: "0.8"
  PYTHON_VERSION: "{{ cookiecutter.python_version }}"
  BASE_LAYER: bookworm-slim
  # GitLab CI creates a separate mountpoint for the build directory,
  # so we need to copy instead of using hard links.
  UV_LINK_MODE: copy

# Define a reusable base job configuration
.base_py_job:
  image: ghcr.io/astral-sh/uv:$UV_VERSION-python$PYTHON_VERSION-$BASE_LAYER
  before_script:
    - uv sync --group dev

# --- Job Definitions ---

format-check:
  extends: .base_py_job
  stage: quality
  script:
    - echo "Checking formatting with Ruff..."
    - uv run ruff format --check .

lint:
  extends: .base_py_job
  stage: quality
  script:
    - echo "Linting with Ruff..."
    - uv run ruff check .

type-check:
  extends: .base_py_job
  stage: quality
  script:
    - echo "Type checking with MyPy..."
    - uv run mypy src/{{ cookiecutter.project_slug }}
