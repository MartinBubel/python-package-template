# This file is automatically generated by Cookiecutter.

# Define the stages of the pipeline
stages:
  - quality

# Define a reusable base job configuration
.base_py_job:
  image: python:{{ cookiecutter.python_version }}-slim
  before_script:
    # 1. Install curl to fetch the uv installer
    - apt-get update && apt-get install -y curl
    # 2. Install the uv binary using the official installer
    - curl -LsSf https://astral.sh/uv/install.sh | sh
    # 3. Add uv to the PATH for subsequent commands
    - export PATH="$HOME/.local/bin:$PATH"
    # 4. Verify installation and install project dependencies
    - uv --version
    - uv pip sync --all-extras

# --- Job Definitions ---

format-check:
  extends: .base_py_job
  stage: quality
  script:
    - echo "Checking formatting with Ruff..."
    - uv run ruff format --check .

lint:
  extends: .base_py_job
  stage: quality
  script:
    - echo "Linting with Ruff..."
    - uv run ruff check .

type-check:
  extends: .base_py_job
  stage: quality
  script:
    - echo "Type checking with MyPy..."
    - uv run mypy src/{{ cookiecutter.project_slug }}
